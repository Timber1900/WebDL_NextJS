(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7345:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var n=r(3717),a=r(1632),s=r(9424),i=r.n(s),o=r(3899),c=r(4387),u=r(7843),l=r.n(u),d=r(3369),f=r(8914),p=r(7112),h=r(2138),v=function(){function e(t){var r=this;(0,d.Z)(this,e),(0,p.Z)(this,"ffmpeg",void 0),(0,p.Z)(this,"onProgress",void 0),this.ffmpeg=(0,h.createFFmpeg)({corePath:"/ffmpeg-core/dist/ffmpeg-core.js",log:null!==t&&void 0!==t&&t,progress:function(e){return r.update_progess(e)}})}return(0,f.Z)(e,[{key:"update_progess",value:function(e){this.onProgress(e)}},{key:"write_video",value:function(){var e=(0,o.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ffmpeg.isLoaded()){e.next=2;break}throw new Error("ffmpeg is not loaded");case 2:return e.prev=2,e.t0=this.ffmpeg,e.t1=Uint8Array,e.next=7,t.data.arrayBuffer();case 7:e.t2=e.sent,e.t3=new e.t1(e.t2),e.t0.FS.call(e.t0,"writeFile","video.mkv",e.t3),e.next=15;break;case 12:throw e.prev=12,e.t4=e.catch(2),e.t4;case 15:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"write_audio",value:function(){var e=(0,o.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ffmpeg.isLoaded()){e.next=2;break}throw new Error("ffmpeg is not loaded");case 2:return e.prev=2,e.t0=this.ffmpeg,e.t1=Uint8Array,e.next=7,t.data.arrayBuffer();case 7:e.t2=e.sent,e.t3=new e.t1(e.t2),e.t0.FS.call(e.t0,"writeFile","audio.m4a",e.t3),e.next=15;break;case 12:throw e.prev=12,e.t4=e.catch(2),e.t4;case 15:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,o.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.ffmpeg.load();case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"merge_video",value:function(){var e=(0,o.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.ffmpeg.run("-i","audio.m4a","-i","video.mkv","-map","0:a","-map","1:v","-c:v","copy","out.mkv");case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"result",get:function(){return this.ffmpeg.FS("readFile","out.mkv")}},{key:"loaded",get:function(){return this.ffmpeg.isLoaded()}}]),e}();function m(e,t){var r=new Blob([e]),n=window.URL.createObjectURL(r),a=document.createElement("a");a.href=n,a.setAttribute("download",t),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a),window.URL.revokeObjectURL(n)}function w(){var e=(0,c.useState)(),t=e[0],r=e[1],s=(0,c.useState)(0),u=s[0],d=s[1],f=(0,c.useState)(0),p=f[0],h=f[1],w=(0,c.useRef)(null),x=new v(!1),g=function(){var e=(0,o.Z)(i().mark((function e(){var t,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/info",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:w.current.value})});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,a=n.info,r(a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=(0,o.Z)(i().mark((function e(){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=[]).push(l().post("/api/video",{url:t.videoDetails.video_url,formats:t.formats},{onDownloadProgress:function(e){h(e.loaded/e.total*100)},responseType:"blob",headers:{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}})),r.push(l().post("/api/audio",{url:t.videoDetails.video_url,formats:t.formats},{responseType:"blob",headers:{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}})),Promise.all(r).then(function(){var e=(0,o.Z)(i().mark((function e(r){var n,s,o,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.sort((function(e,t){return e.data.size-t.data.size})),s=(0,a.Z)(n,2),o=s[0],c=s[1],e.prev=1,x.loaded){e.next=5;break}return e.next=5,x.load();case 5:return x.onProgress=function(e){e.duration;var t=e.ratio;e.time;d(100*t)},e.next=8,x.write_video(c);case 8:return e.next=10,x.write_audio(o);case 10:return e.next=12,x.merge_video();case 12:m(x.result,"".concat(t.videoDetails.title,".mkv")),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center w-screen h-screen gap-4 p-8 font-sans text-xl font-semibold text-black ",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center justify-center w-full gap-4 p-4",children:[(0,n.jsx)("input",{ref:w,className:"flex-grow px-2 py-1 bg-gray-300 rounded-md",type:"text"}),(0,n.jsx)("button",{onClick:g,className:"px-2 py-1 transition-colors bg-blue-400 rounded-md w-max hover:bg-blue-500 active:bg-blue-600",children:"Get Info"})]}),t&&(0,n.jsxs)("div",{className:"grid w-full grid-cols-5 grid-rows-1 gap-4 p-4 m-4 h-max",children:[(0,n.jsx)("img",{src:t.videoDetails.thumbnails[t.videoDetails.thumbnails.length-1].url,alt:"Thumbnail",className:"col-span-2 rounded-md shadow-md"}),(0,n.jsxs)("div",{className:"flex flex-col col-span-3",children:[(0,n.jsx)("h1",{className:"text-center",children:t.videoDetails.title}),(0,n.jsxs)("div",{className:"grid w-full h-full gap-2 p-4 place-content-center",children:[(0,n.jsx)("button",{onClick:b,className:"px-2 py-1 bg-blue-400 rounded-md w-max hover:bg-blue-500 active:bg-blue-600",children:"Download"}),(0,n.jsxs)("p",{children:["Download Ratio: ",p]}),(0,n.jsxs)("p",{children:["Convert Ratio: ",u]})]})]})]})]})}},882:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(7345)}])}},function(e){e.O(0,[215,774,888,179],(function(){return t=882,e(e.s=t);var t}));var t=e.O();_N_E=t}]);